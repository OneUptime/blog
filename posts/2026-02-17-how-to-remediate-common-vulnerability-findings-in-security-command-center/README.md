# How to Remediate Common Vulnerability Findings in Security Command Center

Author: [nawazdhandala](https://www.github.com/nawazdhandala)

Tags: GCP, Security Command Center, Vulnerability Remediation, Cloud Security, Best Practices

Description: A hands-on guide to fixing the most common vulnerability findings that Security Command Center flags in your GCP environment, with specific commands and steps.

---

You enabled Security Command Center, and now your dashboard is lit up with findings. That is normal. Every GCP environment has misconfigurations, especially if it has been growing organically without strict governance. The question is not whether you have findings - it is how quickly you can fix them.

In this post, I will go through the most common SCC findings and show you exactly how to remediate each one. No vague advice - just concrete commands and steps.

## Prioritizing Findings

Before diving into fixes, prioritize by severity and impact:

1. CRITICAL findings - fix immediately (active threats, exposed credentials)
2. HIGH findings - fix within 24-48 hours (public-facing misconfigurations)
3. MEDIUM findings - fix within a week (internal security gaps)
4. LOW findings - schedule during regular maintenance

```bash
# Get a count of active findings by severity
gcloud scc findings list ORGANIZATION_ID \
  --source=- \
  --filter='state="ACTIVE"' \
  --format="value(finding.severity)" | sort | uniq -c | sort -rn
```

## Finding: OPEN_FIREWALL

This means a firewall rule allows inbound traffic from 0.0.0.0/0 (the entire internet) to one or more ports.

```bash
# First, identify which rule is the problem
gcloud compute firewall-rules list \
  --filter="sourceRanges:0.0.0.0/0 AND direction=INGRESS" \
  --format="table(name, allowed, sourceRanges)" \
  --project=my-project-id

# Fix by restricting to known IP ranges
gcloud compute firewall-rules update overly-open-rule \
  --source-ranges="10.0.0.0/8,172.16.0.0/12,192.168.0.0/16" \
  --project=my-project-id
```

If the rule needs to allow traffic from the internet (like a load balancer health check), restrict it to Google's health check IP ranges:

```bash
# Allow only Google health check IPs
gcloud compute firewall-rules update health-check-rule \
  --source-ranges="35.191.0.0/16,130.211.0.0/22" \
  --project=my-project-id
```

## Finding: OPEN_SSH_PORT / OPEN_RDP_PORT

SSH (port 22) or RDP (port 3389) is open to the internet. This is a very common attack vector.

```bash
# Delete the overly permissive SSH rule
gcloud compute firewall-rules delete allow-ssh-from-anywhere \
  --project=my-project-id --quiet

# Create a restricted SSH rule for IAP tunnel only
gcloud compute firewall-rules create allow-ssh-iap \
  --network=my-vpc \
  --allow=tcp:22 \
  --source-ranges="35.235.240.0/20" \
  --description="Allow SSH only through IAP tunnel" \
  --project=my-project-id
```

Using IAP (Identity-Aware Proxy) for SSH is the recommended approach. It authenticates users through Google identity before allowing the SSH connection.

## Finding: PUBLIC_BUCKET_ACL

A Cloud Storage bucket has ACLs that grant access to `allUsers` or `allAuthenticatedUsers`.

```bash
# Check the current ACL
gcloud storage buckets describe gs://my-bucket --format="json(acl)"

# Remove all public access
gcloud storage buckets update gs://my-bucket --no-public-access

# Enable uniform bucket-level access to prevent ACL-based public access in the future
gcloud storage buckets update gs://my-bucket --uniform-bucket-level-access
```

If the bucket genuinely needs to serve public content, use a CDN or load balancer in front of it instead of making the bucket directly public.

## Finding: SQL_PUBLIC_IP

A Cloud SQL instance has a public IP address assigned.

```bash
# Check if the instance has a public IP
gcloud sql instances describe my-sql-instance \
  --format="value(ipAddresses)" \
  --project=my-project-id

# Remove the public IP and switch to private IP only
gcloud sql instances patch my-sql-instance \
  --no-assign-ip \
  --network=projects/my-project-id/global/networks/my-vpc \
  --project=my-project-id
```

After switching to private IP, update your application's connection string. If you need external access for administration, use Cloud SQL Proxy instead.

## Finding: SQL_NO_ROOT_PASSWORD

A Cloud SQL instance has no root password set.

```bash
# Set a password for the root user
gcloud sql users set-password root \
  --host="%" \
  --instance=my-sql-instance \
  --password="$(openssl rand -base64 32)" \
  --project=my-project-id
```

Store the generated password in Secret Manager:

```bash
# Store the password in Secret Manager
echo -n "generated-password-here" | \
  gcloud secrets create sql-root-password \
  --data-file=- \
  --project=my-project-id
```

## Finding: SERVICE_ACCOUNT_KEY_NOT_ROTATED

Service account keys have not been rotated in over 90 days.

```bash
# List all keys for a service account with creation dates
gcloud iam service-accounts keys list \
  --iam-account=my-sa@my-project-id.iam.gserviceaccount.com \
  --format="table(name.basename(), validAfterTime, validBeforeTime)"

# Create a new key
gcloud iam service-accounts keys create new-key.json \
  --iam-account=my-sa@my-project-id.iam.gserviceaccount.com

# Delete the old key (after updating all systems that use it)
gcloud iam service-accounts keys delete OLD_KEY_ID \
  --iam-account=my-sa@my-project-id.iam.gserviceaccount.com --quiet
```

Better yet, eliminate the key entirely by using workload identity federation or attached service accounts.

## Finding: OVER_PRIVILEGED_SERVICE_ACCOUNT_USER

A service account has overly broad roles like `roles/editor` or `roles/owner`.

```bash
# Check what roles are granted to the service account
gcloud projects get-iam-policy my-project-id \
  --flatten="bindings[].members" \
  --filter="bindings.members:my-sa@my-project-id.iam.gserviceaccount.com" \
  --format="table(bindings.role)"

# Remove the overly broad role
gcloud projects remove-iam-policy-binding my-project-id \
  --member="serviceAccount:my-sa@my-project-id.iam.gserviceaccount.com" \
  --role="roles/editor"

# Grant specific, narrow roles instead
gcloud projects add-iam-policy-binding my-project-id \
  --member="serviceAccount:my-sa@my-project-id.iam.gserviceaccount.com" \
  --role="roles/storage.objectViewer"
```

Use the IAM Recommender to figure out which specific permissions the service account actually needs.

## Finding: AUDIT_LOGGING_DISABLED

Cloud Audit Logging is not enabled for all services.

```bash
# Get the current IAM policy to check audit config
gcloud projects get-iam-policy my-project-id --format=json > policy.json
```

Add an audit config section to the policy:

```json
{
  "auditConfigs": [
    {
      "service": "allServices",
      "auditLogConfigs": [
        { "logType": "ADMIN_READ" },
        { "logType": "DATA_READ" },
        { "logType": "DATA_WRITE" }
      ]
    }
  ]
}
```

```bash
# Apply the updated policy
gcloud projects set-iam-policy my-project-id policy.json
```

## Finding: KMS_KEY_NOT_ROTATED

Cloud KMS encryption keys are not configured for automatic rotation.

```bash
# Set automatic rotation every 90 days
gcloud kms keys update my-key \
  --location=global \
  --keyring=my-keyring \
  --rotation-period=7776000s \
  --next-rotation-time=$(date -u -d "+1 day" +%Y-%m-%dT%H:%M:%SZ) \
  --project=my-project-id
```

## Finding: FLOW_LOGS_DISABLED

VPC Flow Logs are not enabled on subnets.

```bash
# Enable flow logs on a specific subnet
gcloud compute networks subnets update my-subnet \
  --region=us-central1 \
  --enable-flow-logs \
  --logging-flow-sampling=0.5 \
  --logging-metadata=include-all \
  --project=my-project-id
```

To enable flow logs on all subnets in a project:

```bash
# Enable flow logs on all subnets in the project
for subnet in $(gcloud compute networks subnets list --format="value(name,region)" --project=my-project-id); do
  name=$(echo $subnet | cut -f1)
  region=$(echo $subnet | cut -f2)
  gcloud compute networks subnets update $name \
    --region=$region \
    --enable-flow-logs \
    --project=my-project-id
done
```

## Tracking Remediation Progress

After fixing findings, they should automatically transition to INACTIVE state on the next SCC scan (typically within hours).

```bash
# Check if a specific finding has been resolved
gcloud scc findings list ORGANIZATION_ID \
  --source=- \
  --filter='finding.category="OPEN_FIREWALL" AND state="INACTIVE"' \
  --format="table(finding.resourceName, finding.state, finding.eventTime)" \
  --limit=10
```

## Conclusion

Remediating SCC findings is not glamorous work, but it is some of the highest-impact security work you can do. Each finding you fix closes a real attack path in your environment. Start with the critical and high severity findings, work through them systematically, and set up notifications so new findings get caught quickly. Over time, your SCC dashboard should show a steady decline in active findings - that is the measure of a well-maintained GCP environment.
